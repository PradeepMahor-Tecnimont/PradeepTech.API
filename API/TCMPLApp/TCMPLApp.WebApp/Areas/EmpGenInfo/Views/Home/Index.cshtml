@{
    ViewData["Title"] = "Home Page";
}

@section BreadCrumbs
{
    <ol class="breadcrumb">
        <li class="breadcrumb-item active" aria-current="page">Employee General information</li>
    </ol>
}
@section Styles {

    <link href="@Url.Content("~/css/drome-style.css")" rel="stylesheet" type="text/css" asp-append-version="true" />
}

<div class="col-12">
    <div class="d-flex justify-content-end p-r-2 m-b-10 m-r-5">
        <a href="http://portal.ticb.comp/OtherDoc/Information%20%20User%20Manuals/Employee%20General%20Information.pdf" target="_blank">
            <i class="fas fa-info-circle fa-2x"></i>
        </a>
    </div>
</div>

<div class="col-sm-12">
    <div class="row">

        @if (CurrentUserIdentity.ProfileActions.Any(p => p.ActionId == TCMPLApp.Domain.Models.EmpGenInfo.EmpGenInfoHelper.ActionEGIUserAccess))
        {
            @if (CurrentUserIdentity.ProfileActions.Any(p => p.ActionId == TCMPLApp.Domain.Models.EmpGenInfo.EmpGenInfoHelper.ActionEGIUpdateSelfInfo))
            {
                <div class="col-sm-6 col-md-4 col-xl-3">
                    <div class="card card-tpl">
                        <div class="card-header">
                            <h5>Employee General Information</h5>
                        </div>
                        <div class="card-block card-tile">
                            <a href="@Url.Action("EmpGenInformationIndex", "EmpGenInfoDetails", new { Area = "EmpGenInfo" })">
                                <div class="row align-items-center justify-content-center stretched-link">
                                    <div class="col">
                                        <h7 class="mb-2 f-w-300"></h7>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-user-alt f-20 text-white theme-light-teal"></i>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

            }

        }

        @if (CurrentUserIdentity.ProfileActions.Any(p => p.ActionId == TCMPLApp.Domain.Models.EmpGenInfo.EmpGenInfoHelper.ActionVPPUpdateInfo))
        {
            <div class="col-sm-6 col-md-4 col-xl-3">
                <div class="card card-tpl">
                    <div class="card-header">
                        <h5>Voluntary parents policy</h5>
                    </div>
                    <div class="card-block card-tile">
                        <a href="~/EmpGenInfo/GeneralInfo/VoluntaryParentPolicyIndex">
                            <div class="row align-items-center justify-content-center stretched-link">
                                <div class="col">
                                    <h7 class="mb-2 f-w-300"></h7>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-user-alt f-20 text-white theme-light-teal"></i>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        }

        @if (CurrentUserIdentity.ProfileActions.Any(p => p.ActionId == TCMPLApp.Domain.Models.EmpGenInfo.EmpGenInfoHelper.ActionVPPManagement))
        {
            <div class="col-sm-6 col-md-4 col-xl-3">
                <div class="card card-tpl">
                    <div class="card-header">
                        <h5>HR Voluntary parents policy</h5>
                    </div>
                    <div class="card-block card-tile">
                        <a href="~/EmpGenInfo/GeneralInfo/VoluntaryParentPolicyForHRIndex">
                            <div class="row align-items-center justify-content-center stretched-link">
                                <div class="col">
                                    <h7 class="mb-2 f-w-300">
                                        List of voluntary parents policy locked by employees
                                    </h7>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-user-alt f-20 text-white theme-light-teal"></i>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        }

        @if (CurrentUserIdentity.ProfileActions.Any(p => p.ActionId == TCMPLApp.Domain.Models.EmpGenInfo.EmpGenInfoHelper.ActionICardPhotoConsent))
        {
            <div class="col-sm-6 col-md-4 col-xl-3">
                <div class="card card-tpl" data-title="HR Voluntary parents policy">
                    <div class="card-header">
                        <h5>Consent for icard photo</h5>
                    </div>
                    <div class="card-block card-tile">
                        <a href="~/EmpGenInfo/IcardConsent/Index">
                            <div class="row align-items-center justify-content-center stretched-link">
                                <div class="col">
                                    <h7 class="mb-2 f-w-300">
                                        Employee consent to use photo on icard
                                    </h7>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-id-card f-20 text-white theme-dark-orange"></i>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        }
        @if (CurrentUserIdentity.ProfileActions.Any(p => p.ActionId == TCMPLApp.Domain.Models.EmpGenInfo.EmpGenInfoHelper.ActionEmpRelativesColleaguesUser))
        {
            <div class="col-sm-6 col-md-4 col-xl-3">
                <div class="card card-tpl alerts-border" data-title="Employment of relatives ">
                    <div class="card-header">
                        <h5>Employment of relatives </h5>
                    </div>
                    <div class="card-block card-tile">
                        @* <a href="~/EmpGenInfo/IcardConsent/EmploymentOfRelativesIndex"> *@
                        <a href="@Url.Action("EmploymentOfRelativesIndex", "EmpGenInfoDetails", new { Area = "EmpGenInfo" })">
                            <div class="row align-items-center justify-content-center stretched-link">
                                <div class="col">
                                    <h7 class="mb-2 f-w-300">
                                        Employment of relatives
                                    </h7>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-id-card f-20 text-white theme-dark-green"></i>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        }
        @if (CurrentUserIdentity.ProfileActions.Any(p => p.ActionId == TCMPLApp.Domain.Models.EmpGenInfo.EmpGenInfoHelper.ActionEmpAddendumUser))
        {
            <div class="col-sm-6 col-md-4 col-xl-3">
                <div class="card card-tpl alerts-border" data-title="HR Voluntary parents policy">
                    <div class="card-header">
                        <h5>Addendum to Appointment Letter</h5>
                    </div>
                    <div class="card-block card-tile">
                        <a href="@Url.Action("LoAAddendumAppointmentLetterIndex", "EmpGenInfoDetails", new { Area = "EmpGenInfo" })">
                            <div class="row align-items-center justify-content-center stretched-link">
                                <div class="col">
                                    <h7 class="mb-2 f-w-300">
                                        Addendum to Appointment Letter
                                    </h7>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-id-card f-20 text-white theme-dark-orange"></i>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        }
    </div>
</div>
<hr />
<div class="col-sm-12">
    <div class="row">

        @if (CurrentUserIdentity.ProfileActions.Any(p => p.ActionId == TCMPLApp.Domain.Models.EmpGenInfo.EmpGenInfoHelper.ActionEGIUserAccess))
        {

            @if (CurrentUserIdentity.ProfileActions.Any(p => p.ActionId == TCMPLApp.Domain.Models.EmpGenInfo.EmpGenInfoHelper.ActionEGILock))
            {
                <div class="col-sm-6 col-md-4 col-xl-3">
                    <div class="card card-tpl">
                        <div class="card-header">
                            <h5>HR -  Lock Status /Employees data modification</h5>
                        </div>
                        <div class="card-block card-tile">
                            <a href="@Url.Action("LockStatusIndex", "EmpGenInfoDetails", new { Area = "EmpGenInfo" })">
                                <div class="row align-items-center justify-content-center stretched-link">
                                    <div class="col">
                                        <h7 class="mb-2 f-w-300">
                                            Lock Status /Employees General Info
                                        </h7>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-lock f-20 text-white theme-light-teal"></i>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-md-4 col-xl-3">
                    <div class="card card-tpl">
                        <div class="card-header">
                            <h5>HR - Nomination Submit Status</h5>
                        </div>
                        <div class="card-block card-tile">
                            <a href="@Url.Action("NominationSubmitStatusIndex", "Report", new { Area = "EmpGenInfo" })">
                                <div class="row align-items-center justify-content-center stretched-link">
                                    <div class="col">
                                        <h7 class="mb-2 f-w-300"></h7>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-lock f-20 text-white theme-light-teal"></i>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-md-4 col-xl-3">
                    <div class="card card-tpl">
                        <div class="card-header">
                            <h5>HR - GTLI Submit Status</h5>
                        </div>
                        <div class="card-block card-tile">
                            <a href="@Url.Action("GTLISubmitStatusIndex", "Report", new { Area = "EmpGenInfo" })">
                                <div class="row align-items-center justify-content-center stretched-link">
                                    <div class="col">
                                        <h7 class="mb-2 f-w-300"></h7>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-lock f-20 text-white theme-light-teal"></i>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
                @*  <environment include="Development"> *@
                <div class="col-sm-6 col-md-4 col-xl-3">
                    <div class="card card-tpl">
                        <div class="card-header">
                            <h5>HR - VPP Configuration Process</h5>
                        </div>
                        <div class="card-block card-tile">
                            <a href="@Url.Action("VppConfigProcessIndex", "VppConfigProcess", new { Area = "EmpGenInfo" })">
                                <div class="row align-items-center justify-content-center stretched-link">
                                    <div class="col">
                                        <h7 class="mb-2 f-w-300"></h7>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa fa-cog f-20 text-white theme-light-teal"></i>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
                @*  </environment> *@
            }
        }

        @if (CurrentUserIdentity.ProfileActions.Any(p => p.ActionId == TCMPLApp.Domain.Models.EmpGenInfo.EmpGenInfoHelper.ActionICardPhotoConsentHR))
        {
            <div class="col-sm-6 col-md-4 col-xl-3">
                <div class="card card-tpl">
                    <div class="card-header">
                        <h5>HR - ICard Photo Consent Status</h5>
                    </div>
                    <div class="card-block card-tile">
                        <a href="@Url.Action("IcardConsentStatusIndex", "IcardConsent", new { Area = "EmpGenInfo" })">
                            <div class="row align-items-center justify-content-center stretched-link">
                                <div class="col">
                                    <h7 class="mb-2 f-w-300"></h7>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-id-card f-20 text-white theme-dark-orange"></i>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        }
        @if (CurrentUserIdentity.ProfileActions.Any(p => p.ActionId == TCMPLApp.Domain.Models.EmpGenInfo.EmpGenInfoHelper.ActionEmpAddendumRelativesColleaguesHR))
        {
            <div class="col-sm-6 col-md-4 col-xl-3">
                <div class="card card-tpl"
                     data-title="HR Voluntary parents policy">
                    <div class="card-header header-flex">
                        <h5>Addendum to Appointment Status</h5>
                    </div>
                    <div class="card-block card-tile">
                        <a href="@Url.Action("LoAAddendumAppointmentIndex", "EmpGenInfoDetails", new { Area = "EmpGenInfo" })">
                            <div class="row align-items-center justify-content-center stretched-link">
                                <div class="col">
                                    <div class="row align-items-center justify-content-center stretched-link">
                                        &#160
                                        <div class="col-12 text-black text-right" style="font-size:1.2rem">@ViewBag.AddendumAcceptanceRating</div>
                                    </div>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-id-card f-20 text-white theme-dark-orange"></i>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
            <div class="col-sm-6 col-md-4 col-xl-3">
                <div class="card card-tpl"
                     data-title="HR Voluntary parents policy">
                    <div class="card-header header-flex">
                        <h5>Employee Relatives As Colleague Status</h5>
                    </div>
                    <div class="card-block card-tile">
                        <a href="@Url.Action("EmpRelativesAsColleaguesIndex", "EmpGenInfoDetails", new { Area = "EmpGenInfo" })">
                            <div class="row align-items-center justify-content-center stretched-link">
                                <div class="col">
                                    <div class="row align-items-center justify-content-center stretched-link">
                                        &#160
                                        <div class="col-12 text-black text-right" style="font-size:1.2rem">@ViewBag.EmpRelativeRating </div>
                                    </div>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-id-card f-20 text-white theme-dark-orange"></i>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        }
    </div>
</div>

<hr />
<div class="col-sm-12">
    <div class="row">

        @if (CurrentUserIdentity.ProfileActions.Any(p => p.ActionId == TCMPLApp.Domain.Models.EmpGenInfo.EmpGenInfoHelper.ActionEGIUserAccess))
        {
            @if (CurrentUserIdentity.ProfileActions.Any(p => p.ActionId == TCMPLApp.Domain.Models.EmpGenInfo.EmpGenInfoHelper.ActionEGIUpdateOnBehalf))
            {
                <div class="col-sm-6 col-md-4 col-xl-3">
                    <div class="card card-tpl">
                        <div class="card-header">
                            <h5>Employee Nominee Details - Report</h5>
                        </div>
                        <div class="card-block card-tile">
                            <a id="lEmployeeNomineeDetails" href="#"
                               data-inprogress="0"
                               data-jqueryselector="generatereport"
                               data-url="@Url.Action("EmployeeNomineeDetailsExcel", "Report", new { Area = "EmpGenInfo" })">
                                <div class="row align-items-center justify-content-center stretched-link">
                                    <div class="col">
                                        <h7 id="lEmployeeNomineeDetails_Text" class="mb-2 f-w-300">
                                        </h7>
                                        <div class="text-center">
                                            <div id="lEmployeeNomineeDetails_Loader" class="spinner-border text-info text-center hidden "
                                                 style="width: 2.5rem; height: 2.5rem;" role="status">
                                                <span class="sr-only">Loading...</span>
                                            </div>
                                        </div>
                                        &#160;
                                    </div>
                                    <div id="lEmployeeNomineeDetails_Icon" class="col-auto">
                                        <i class="fas fa-cogs f-20 text-white theme-dark-green"></i>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="col-sm-6 col-md-4 col-xl-3">
                    <div class="card card-tpl">
                        <div class="card-header">
                            <h5>Employee Family Details - Report</h5>
                        </div>
                        <div class="card-block card-tile">
                            <a id="lEmployeeFamilyDetails" href="#"
                               data-inprogress="0"
                               data-jqueryselector="generatereport"
                               data-url="@Url.Action("EmployeeFamilyDetailsExcel", "Report", new { Area = "EmpGenInfo" })">
                                <div class="row align-items-center justify-content-center stretched-link">
                                    <div class="col">
                                        <h7 id="lEmployeeFamilyDetails_Text" class="mb-2 f-w-300">
                                        </h7>
                                        <div class="text-center">
                                            <div id="lEmployeeFamilyDetails_Loader" class="spinner-border text-info text-center hidden "
                                                 style="width: 2.5rem; height: 2.5rem;" role="status">
                                                <span class="sr-only">Loading...</span>
                                            </div>
                                        </div>
                                        &#160;
                                    </div>
                                    <div id="lEmployeeFamilyDetails_Icon" class="col-auto">
                                        <i class="fas fa-cogs f-20 text-white theme-dark-green"></i>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="col-sm-6 col-md-4 col-xl-3">
                    <div class="card card-tpl">
                        <div class="card-header">
                            <h5>Employee Mediclaim Details - Report</h5>
                        </div>
                        <div class="card-block card-tile">
                            <a href="#"
                               data-jqueryselector="openmodal"
                               data-modalcontainer="modalcontainer"
                               data-modalpopupwidth="rightw35"
                               data-url='@Url.Action("EmployeeMediclaimDetailsExcel", "Report", new { Area = "EmpGenInfo" })'>
                                <div class="row align-items-center justify-content-center stretched-link">
                                    <div class="col">
                                        <h3 class="mb-2 f-w-300"> </h3>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-cogs f-20 text-white theme-dark-green"></i>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="col-sm-6 col-md-4 col-xl-3">
                    <div class="card card-tpl">
                        <div class="card-header">
                            <h5>Employee Details Not Filled - Report</h5>
                        </div>
                        <div class="card-block card-tile">
                            <a id="lEmployeeDetailsNotFilled" href="#"
                               data-inprogress="0"
                               data-jqueryselector="generatereport"
                               data-url="@Url.Action("EmployeeDetailsNotFilledExcel", "Report", new { Area = "EmpGenInfo" })">
                                <div class="row align-items-center justify-content-center stretched-link">
                                    <div class="col">
                                        <h7 id="lEmployeeDetailsNotFilled_Text" class="mb-2 f-w-300">
                                        </h7>
                                        <div class="text-center">
                                            <div id="lEmployeeDetailsNotFilled_Loader" class="spinner-border text-info text-center hidden "
                                                 style="width: 2.5rem; height: 2.5rem;" role="status">
                                                <span class="sr-only">Loading...</span>
                                            </div>
                                        </div>
                                        &#160;
                                    </div>
                                    <div id="lEmployeeDetailsNotFilled_Icon" class="col-auto">
                                        <i class="fas fa-cogs f-20 text-white theme-dark-green"></i>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="col-sm-6 col-md-4 col-xl-3">
                    <div class="card card-tpl">
                        <div class="card-header">
                            <h5>Employee Details All - Report</h5>
                        </div>
                        <div class="card-block card-tile">
                            <a id="lEmployeeDetailsAll" href="#"
                               data-inprogress="0"
                               data-jqueryselector="generatereport"
                               data-url="@Url.Action("EmployeeDetailsAllExcel", "Report", new { Area = "EmpGenInfo" })">
                                <div class="row align-items-center justify-content-center stretched-link">
                                    <div class="col">
                                        <h7 id="lEmployeeDetailsAll_Text" class="mb-2 f-w-300">
                                        </h7>
                                        <div class="text-center">
                                            <div id="lEmployeeDetailsAll_Loader" class="spinner-border text-info text-center hidden "
                                                 style="width: 2.5rem; height: 2.5rem;" role="status">
                                                <span class="sr-only">Loading...</span>
                                            </div>
                                        </div>
                                        &#160;
                                    </div>
                                    <div id="lEmployeeDetailsAll_Icon" class="col-auto">
                                        <i class="fas fa-cogs f-20 text-white theme-dark-green"></i>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="col-sm-6 col-md-4 col-xl-3">
                    <div class="card card-tpl">
                        <div class="card-header">
                            <h5>Employee Aadhaar Details - Report</h5>
                        </div>
                        <div class="card-block card-tile">
                            <a id="lEmployeeAadhaarDetails" href="#"
                               data-inprogress="0"
                               data-jqueryselector="generatereport"
                               data-url="@Url.Action("EmployeeAadhaarDetailsExcel", "Report", new { Area = "EmpGenInfo" })">
                                <div class="row align-items-center justify-content-center stretched-link">
                                    <div class="col">
                                        <h7 id="lEmployeeAadhaarDetails_Text" class="mb-2 f-w-300">
                                        </h7>
                                        <div class="text-center">
                                            <div id="lEmployeeAadhaarDetails_Loader" class="spinner-border text-info text-center hidden "
                                                 style="width: 2.5rem; height: 2.5rem;" role="status">
                                                <span class="sr-only">Loading...</span>
                                            </div>
                                        </div>
                                        &#160;
                                    </div>
                                    <div id="lEmployeeAadhaarDetails_Icon" class="col-auto">
                                        <i class="fas fa-cogs f-20 text-white theme-dark-green"></i>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="col-sm-6 col-md-4 col-xl-3">
                    <div class="card card-tpl">
                        <div class="card-header">
                            <h5>Ex Employee Nominee Details - Report</h5>
                        </div>
                        <div class="card-block card-tile">
                            <a href="#"
                               data-jqueryselector="openmodal"
                               data-modalcontainer="modalcontainer"
                               data-modalpopupwidth="rightw25"
                               data-url="@Url.Action("Ex_EmployeeNomineeDetailsExcel", "Report", new { Area = "EmpGenInfo" })">
                                <div class="row align-items-center justify-content-center stretched-link">
                                    <div class="col">
                                        <h3 class="mb-2 f-w-300"> </h3>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-cogs f-20 text-white theme-dark-green"></i>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="col-sm-6 col-md-4 col-xl-3">
                    <div class="card card-tpl">
                        <div class="card-header">
                            <h5>Ex Employee Contact Details - Report</h5>
                        </div>
                        <div class="card-block card-tile">
                            <a href="#"
                               data-jqueryselector="openmodal"
                               data-modalcontainer="modalcontainer"
                               data-modalpopupwidth="rightw25"
                               data-url="@Url.Action("Ex_EmployeeContactDetailsExcel", "Report", new { Area = "EmpGenInfo" })">
                                <div class="row align-items-center justify-content-center stretched-link">
                                    <div class="col">
                                        <h3 class="mb-2 f-w-300"> </h3>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-cogs f-20 text-white theme-dark-green"></i>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            }

        }
    </div>
</div>

@section Scripts {

    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    <script src="~/js/site-rap.js" asp-append-version="true"></script>
    <script>

        $(document).ready(function () {

        });

        function localScript() {
            initSelect2();
            initDatePicker();
            initFilter();

            $('#btnExportMediclaimStatusExcel').off('click').on('click', function () {
                event.preventDefault();
                event.stopPropagation();
                exportMediclaimStatusExcel();
            });

            $('#btnExportExEmployeeNomineeDetailsExcel').off('click').on('click', function () {
                event.preventDefault();
                event.stopPropagation();
                exportExEmployeeNomineeDetailsExcel();
            });
            $('#btnExportExEmployeeContactDetailsExcel').off('click').on('click', function () {
                event.preventDefault();
                event.stopPropagation();
                exportExEmployeeContactDetailsExcel();
            });

        }
        function initDatePicker() {
            $('.datepicker').bootstrapMaterialDatePicker({
                format: 'DD-MMM-YYYY',
                weekStart: 0,
                time: false,
                useCurrent: false,
                nowButton: true,
                clearButton: true
            });

            $("#endDate").on("change", function (event, date) {
                $("#EndDate").val($(this).val());
            });
            $("#startDate").on("change", function (event, date) {

                $("#StartDate").val($(this).val());
                if ($("#endDate").val()) {
                    let startDate = moment($(this).val(), "DD-MMM-YYYY");
                    let endDate = moment($("#endDate").val(), "DD-MMM-YYYY");
                    if (endDate < startDate) {
                        $("#endDate").val('');
                        $('#endDate').val(moment(startDate).format("DD-MMM-YYYY"));
                    }
                }
                else {
                    $("#endDate").val($(this).val());
                }

                $("#endDate").bootstrapMaterialDatePicker('setDate', $(this).val());
                $("#endDate").trigger('change');
            });

        }

        function initFilter() {

            $('.datepickerFilter').bootstrapMaterialDatePicker({
                format: 'DD-MMM-YYYY',
                weekStart: 0,
                time: false,
                useCurrent: false
            });

            $('#startDateFilter').bootstrapMaterialDatePicker({
                format: 'DD-MMM-YYYY',
                weekStart: 0,
                time: false
            }).on('change', function (e, date) {
                $('#endDateFilter').bootstrapMaterialDatePicker('setMinDate', date);
                $("#StartDate").val(date.format('DD-MMM-YYYY'));
            });

            $('#endDateFilter').bootstrapMaterialDatePicker({
                format: 'DD-MMM-YYYY',
                weekStart: 0,
                time: false
            }).on('change', function (e, date) {
                $("#EndDate").val(date.format('DD-MMM-YYYY'));
            });

            var curdate = new Date();

            var minYear = curdate.getFullYear() - 1;
            var maxYear = curdate.getFullYear();

            $('.selectYearFilter').datepicker({
                format: "yyyy",
                startView: "years",
                minViewMode: "years",
                maxViewMode: "years",
                changeYear: true,
                clearBtn: true,
                defaultViewDate: {
                    year: maxYear
                },
                startDate: '-25y', //2021 -1950
                endDate: 'y' //'+1y' //2021-2011
            });

            $('#SelectYearFilter').datepicker({
                format: 'yyyy',
                changeYear: true,

            }).on('change', function (e, date) {

                var fvDate = $(this).val();
                if (fvDate) {
                    $("#SelectYear").val(moment(fvDate, 'YYYY').format("YYYY"));
                }
                else {
                    $("#SelectYear").val("");
                }
                $(this).datepicker('hide');
            });
            if ($("#SelectYear").val()) {
                $('#SelectYearFilter').val(moment($("#SelectYear").val(), "YYYY").format('YYYY'));
            }
        }

        function exportMediclaimStatusExcel() {

            let vStartDate = $("#formEmployeeMediclaimDetailsExcel input[id=StartDate]").val();
            let vEndDate = $("#formEmployeeMediclaimDetailsExcel input[id=EndDate]").val();

            if (vStartDate == null || vStartDate == '') {
                toastr.error('Invalid Start Date ');
                return;
            }
            if (vEndDate == null || vEndDate == '') {
                toastr.error('Invalid End Date');
                return;
            }

            $.ajax({
                headers: { "RequestVerificationToken": $('#EmployeeMediclaimDetailsExcel input[name="__RequestVerificationToken"]').val() },
                url: '@Url.Action("EmployeeMediclaimDetailsExcel", "Report", new { Area = "EmpGenInfo" })',
                type: "POST",
                data: {
                    startDate: vStartDate,
                    endDate: vEndDate
                },
                cache: false,
                xhr: function () {
                    var xhr = new XMLHttpRequest();
                    xhr.onreadystatechange = function () {
                        if (xhr.readyState == 2) {
                            if (xhr.status == 200) {
                                xhr.responseType = "blob";
                            }
                        }
                    };
                    return xhr;
                },
                beforeSend: function () {
                    showLoader();
                    $("#btnExportMediclaimStatusExcel").hide();
                    $('#MediclaimStatus_Loader').removeClass("hidden");
                },

                success: function (blob, status, xhr) {

                    var filename = "";
                    var disposition = xhr.getResponseHeader('Content-Disposition');
                    if (disposition && disposition.indexOf('attachment') !== -1) {
                        var filenameRegex = /filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/;
                        var matches = filenameRegex.exec(disposition);
                        if (matches != null && matches[1]) filename = matches[1].replace(/['"]/g, '');
                    }
                    var link = document.createElement('a');
                    var url = window.URL.createObjectURL(blob);

                    link.href = window.URL.createObjectURL(blob);
                    link.download = filename;
                    link.click();
                    link.remove();
                    window.URL.revokeObjectURL(url);
                    toastr.success("File downloaded successfully.");
                    hideLoader();
                    $("#modalcontainer").modal('hide');

                    $("#btnExportMediclaimStatusExcel").show();
                    $('#MediclaimStatus_Loader').addClass("hidden");
                },
                error: function (xhr) {
                    showError(xhr);
                    hideLoader();
                    $("#btnExportMediclaimStatusExcel").show();
                    $('#MediclaimStatus_Loader').addClass("hidden");
                }
            });
        }

        function exportExEmployeeNomineeDetailsExcel() {

            let vSelectYear = $("#formExEmployeeNomineeDetailsExcel input[id=SelectYear]").val();
            let vEmpNo = $("#formExEmployeeNomineeDetailsExcel textarea[id=Empno]").val();

            if (vSelectYear == null && vEmpNo == null) {
                toastr.error('Please Select Any One Field.! ');
                return;
            }

            if (vEmpNo != '') {
                if (vEmpNo.length < 4) {
                    toastr.error('Please Enter Valid Emp No.! ');
                    return;
                }
            }

            $.ajax({
                headers: { "RequestVerificationToken": $('#Ex_EmployeeNomineeDetailsExcel input[name="__RequestVerificationToken"]').val() },
                url: '@Url.Action("Ex_EmployeeNomineeDetailsExcel", "Report", new { Area = "EmpGenInfo" })',
                type: "POST",
                data: {
                    selectYear: vSelectYear,
                    empno: vEmpNo
                },
                cache: false,
                xhr: function () {
                    var xhr = new XMLHttpRequest();
                    xhr.onreadystatechange = function () {
                        if (xhr.readyState == 2) {
                            if (xhr.status == 200) {
                                xhr.responseType = "blob";
                            }
                        }
                    };
                    return xhr;
                },
                beforeSend: function () {
                    showLoader();
                    $("#btnExportExEmployeeNomineeDetailsExcel").hide();
                    $('#ExEmployeeNomineeDetails_Loader').removeClass("hidden");
                },

                success: function (blob, status, xhr) {

                    var filename = "";
                    var disposition = xhr.getResponseHeader('Content-Disposition');
                    if (disposition && disposition.indexOf('attachment') !== -1) {
                        var filenameRegex = /filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/;
                        var matches = filenameRegex.exec(disposition);
                        if (matches != null && matches[1]) filename = matches[1].replace(/['"]/g, '');
                    }
                    var link = document.createElement('a');
                    var url = window.URL.createObjectURL(blob);

                    link.href = window.URL.createObjectURL(blob);
                    link.download = filename;
                    link.click();
                    link.remove();
                    window.URL.revokeObjectURL(url);
                    toastr.success("File downloaded successfully.");
                    hideLoader();
                    $("#modalcontainer").modal('hide');

                    $("#btnExportExEmployeeNomineeDetailsExcel").show();
                    $('#ExEmployeeNomineeDetails_Loader').addClass("hidden");
                },
                error: function (xhr) {
                    showError(xhr);
                    hideLoader();
                    $("#btnExportExEmployeeNomineeDetailsExcel").show();
                    $('#ExEmployeeNomineeDetails_Loader').addClass("hidden");
                }
            });
        }

        function exportExEmployeeContactDetailsExcel() {

            let vSelectYear = $("#formExEmployeeContactDetailsExcel input[id=SelectYear]").val();
            let vEmpNo = $("#formExEmployeeContactDetailsExcel textarea[id=Empno]").val();

            if (vSelectYear == null && vEmpNo == '') {
                toastr.error('Please Select Any One Field.! ');
                return;
            }

            if (vEmpNo != '') {
                if (vEmpNo.length < 4) {
                    toastr.error('Please Enter Valid Emp No.! ');
                    return;
                }
            }

            $.ajax({
                headers: { "RequestVerificationToken": $('#Ex_EmployeeContactDetailsExcel input[name="__RequestVerificationToken"]').val() },
                url: '@Url.Action("Ex_EmployeeContactDetailsExcel", "Report", new { Area = "EmpGenInfo" })',
                type: "POST",
                data: {
                    selectYear: vSelectYear,
                    empno: vEmpNo
                },
                cache: false,
                xhr: function () {
                    var xhr = new XMLHttpRequest();
                    xhr.onreadystatechange = function () {
                        if (xhr.readyState == 2) {
                            if (xhr.status == 200) {
                                xhr.responseType = "blob";
                            }
                        }
                    };
                    return xhr;
                },
                beforeSend: function () {
                    showLoader();
                    $("#btnExportExEmployeeContactDetailsExcel").hide();
                    $('#ExEmployeeContactDetails_Loader').removeClass("hidden");
                },

                success: function (blob, status, xhr) {

                    var filename = "";
                    var disposition = xhr.getResponseHeader('Content-Disposition');
                    if (disposition && disposition.indexOf('attachment') !== -1) {
                        var filenameRegex = /filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/;
                        var matches = filenameRegex.exec(disposition);
                        if (matches != null && matches[1]) filename = matches[1].replace(/['"]/g, '');
                    }
                    var link = document.createElement('a');
                    var url = window.URL.createObjectURL(blob);

                    link.href = window.URL.createObjectURL(blob);
                    link.download = filename;
                    link.click();
                    link.remove();
                    window.URL.revokeObjectURL(url);
                    toastr.success("File downloaded successfully.");
                    hideLoader();
                    $("#modalcontainer").modal('hide');

                    $("#btnExportExEmployeeContactDetailsExcel").show();
                    $('#ExEmployeeContactDetails_Loader').addClass("hidden");
                },
                error: function (xhr) {
                    showError(xhr);
                    hideLoader();
                    $("#btnExportExEmployeeContactDetailsExcel").show();
                    $('#ExEmployeeContactDetails_Loader').addClass("hidden");
                }
            });
        }
    </script>
}