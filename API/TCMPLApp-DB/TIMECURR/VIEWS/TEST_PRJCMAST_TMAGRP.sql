--------------------------------------------------------
--  DDL for View TEST_PRJCMAST_TMAGRP
--------------------------------------------------------

  CREATE OR REPLACE FORCE VIEW "TIMECURR"."TEST_PRJCMAST_TMAGRP" ("NEWCOSTCODE", "PROJNO", "TCMNO", "NAME", "COSTCODE", "'201804'", "'201805'", "'201806'", "'201807'", "'201808'", "'201809'", "'201810'", "'201811'", "'201812'", "'201901'", "'201902'", "'201903'", "'201904'", "'201905'", "'201906'", "'201907'", "'201908'", "'201909'", "'201910'", "'201911'", "'201912'", "'202001'", "'202002'", "'202003'") AS 
  (
SELECT "NEWCOSTCODE","PROJNO","TCMNO","NAME","COSTCODE","'201804'","'201805'","'201806'","'201807'","'201808'","'201809'","'201810'","'201811'","'201812'","'201901'","'201902'","'201903'","'201904'","'201905'","'201906'","'201907'","'201908'","'201909'","'201910'","'201911'","'201912'","'202001'","'202002'","'202003'" FROM
(
  SELECT A.NEWCOSTCODE  ,A.projno,A.TCMNO,A.NAME,b.costcode,b.yymm,B.hours
  FROM PROJMAST A,prjCMAST B where A.PROJNO = B.PROJNO  and b.yymm >= '201804' 
)
PIVOT
(
  sum(Hours)
  FOR yymm IN ('201804','201805','201806','201807','201808','201809','201810','201811','201812','201901','201902','201903','201904','201905','201906','201907','201908','201909','201910','201911','201912','202001','202002','202003')
)
)
;
